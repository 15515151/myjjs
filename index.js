(function(_0x6d8981,_0x257856){const _0x5d9e80=a0_0x4e12,_0x4c7dd0=_0x6d8981();while(!![]){try{const _0x1c64ae=-parseInt(_0x5d9e80(0xc4))/0x1+parseInt(_0x5d9e80(0xed))/0x2+parseInt(_0x5d9e80(0xdc))/0x3*(-parseInt(_0x5d9e80(0xb8))/0x4)+-parseInt(_0x5d9e80(0xb9))/0x5+parseInt(_0x5d9e80(0xe6))/0x6*(parseInt(_0x5d9e80(0xeb))/0x7)+-parseInt(_0x5d9e80(0xd5))/0x8+parseInt(_0x5d9e80(0xe1))/0x9;if(_0x1c64ae===_0x257856)break;else _0x4c7dd0['push'](_0x4c7dd0['shift']());}catch(_0x2d5937){_0x4c7dd0['push'](_0x4c7dd0['shift']());}}}(a0_0x1468,0x623f5),jQuery(()=>{const _0x2ba6d6=a0_0x4e12;console[_0x2ba6d6(0xbe)](_0x2ba6d6(0xbd));if($('#api-balance-checker-button')[_0x2ba6d6(0xce)]===0x0){const _0x1b9d37=_0x2ba6d6(0xf7);$(_0x2ba6d6(0xfc))[_0x2ba6d6(0xe4)](_0x1b9d37);}if($(_0x2ba6d6(0xd8))['length']===0x0){const _0x475931=_0x2ba6d6(0xdf);$(_0x2ba6d6(0xf8))[_0x2ba6d6(0xe0)](_0x475931);}$(document)['on'](_0x2ba6d6(0xc3),_0x2ba6d6(0xbf),async()=>{const _0x55e303=_0x2ba6d6,_0x21586a=SillyTavern[_0x55e303(0xb5)]();if(typeof _0x21586a[_0x55e303(0xe3)]===_0x55e303(0xfa)){toastr[_0x55e303(0xbc)]('OpenAI\x20settings\x20not\x20loaded\x20yet.\x20Please\x20wait\x20and\x20try\x20again.');return;}const _0x3fa9cc=$('#api-balance-checker-button\x20.drawer-icon');_0x3fa9cc[_0x55e303(0xc8)](_0x55e303(0xc6)),_0x3fa9cc[_0x55e303(0xe5)](_0x55e303(0xcd))[_0x55e303(0xec)](_0x55e303(0xb3));try{let _0x27ba7b=_0x21586a[_0x55e303(0xe3)][_0x55e303(0xc7)],_0x3ba9a9=_0x21586a[_0x55e303(0xe3)][_0x55e303(0xf5)];if(_0x21586a[_0x55e303(0xe3)][_0x55e303(0xf9)]===_0x55e303(0xe7))try{const _0x5da518=_0x21586a[_0x55e303(0xc9)](),_0x57a0b4=await fetch(_0x55e303(0xe8),{'method':_0x55e303(0xc0),'headers':_0x5da518});if(!_0x57a0b4['ok'])throw new Error(_0x55e303(0xde)+_0x57a0b4[_0x55e303(0xf2)]+')');const _0x3c63fc=await _0x57a0b4['json']();if(_0x3c63fc[_0x55e303(0xba)])_0x27ba7b=_0x3c63fc[_0x55e303(0xba)];else throw new Error('Custom\x20API\x20key\x20(api_key_custom)\x20not\x20found\x20in\x20secrets.');}catch(_0x452ea7){console[_0x55e303(0xbc)]('API\x20Balance\x20Checker\x20Error:',_0x452ea7),toastr[_0x55e303(0xbc)](_0x55e303(0xdb)+_0x452ea7[_0x55e303(0xd9)]),_0x3fa9cc[_0x55e303(0xe5)](_0x55e303(0xb3))['addClass'](_0x55e303(0xcd)),_0x3fa9cc['removeClass']('active');return;}if(!_0x3ba9a9||!_0x27ba7b)throw new Error(_0x55e303(0xe2));const _0x480d86=new URL(_0x3ba9a9)[_0x55e303(0xf4)],_0x59258e=_0x480d86+_0x55e303(0xda),_0x32a2df=await fetch(_0x55e303(0xea),{'method':_0x55e303(0xc0),'headers':{'Content-Type':_0x55e303(0xb7)},'body':JSON[_0x55e303(0xd6)]({'apiKey':_0x27ba7b,'apiUrl':_0x59258e})}),_0x57a1e5=await _0x32a2df[_0x55e303(0xca)]();if(_0x32a2df['ok']){if(_0x57a1e5['data']&&_0x57a1e5[_0x55e303(0xfb)][_0x55e303(0xd1)]!==undefined){const _0x5bbed0=_0x57a1e5[_0x55e303(0xfb)][_0x55e303(0xd1)],_0x119f8a=_0x5bbed0/0x7a120;toastr[_0x55e303(0xe9)](_0x55e303(0xbb)+_0x119f8a[_0x55e303(0xd7)](0x2)+_0x55e303(0xf3)+_0x5bbed0+')');}else toastr[_0x55e303(0xbc)]('查询失败:\x20代理返回数据格式不正确。');}else toastr[_0x55e303(0xbc)](_0x55e303(0xd2)+(_0x57a1e5[_0x55e303(0xbc)]||_0x55e303(0xc5)+_0x32a2df[_0x55e303(0xf2)]));}catch(_0x55a50f){console[_0x55e303(0xbc)](_0x55e303(0xcc),_0x55a50f),toastr[_0x55e303(0xbc)](_0x55e303(0xd2)+_0x55a50f[_0x55e303(0xd9)]);}finally{_0x3fa9cc[_0x55e303(0xe5)](_0x55e303(0xb3))['addClass'](_0x55e303(0xcd)),_0x3fa9cc['removeClass'](_0x55e303(0xc6));}});const _0x3e423a=SillyTavern[_0x2ba6d6(0xb5)]();_0x3e423a&&_0x3e423a['eventSource']&&_0x3e423a[_0x2ba6d6(0xb2)]['on'](_0x3e423a[_0x2ba6d6(0xd4)]['GENERATION_ENDED'],async()=>{const _0x48ba89=_0x2ba6d6,_0x304125=$(_0x48ba89(0xc1))['is'](_0x48ba89(0xef));if(!_0x304125)return;try{const _0x32061a=SillyTavern[_0x48ba89(0xb5)]();if(typeof _0x32061a[_0x48ba89(0xe3)]==='undefined'){console['error'](_0x48ba89(0xc2));return;}let _0x47d3b0=_0x32061a[_0x48ba89(0xe3)][_0x48ba89(0xc7)],_0x33a9c7=_0x32061a[_0x48ba89(0xe3)]['custom_url'];if(_0x32061a['chatCompletionSettings']['chat_completion_source']===_0x48ba89(0xe7)){const _0x4989b4=_0x32061a[_0x48ba89(0xc9)](),_0x570165=await fetch(_0x48ba89(0xe8),{'method':_0x48ba89(0xc0),'headers':_0x4989b4});if(!_0x570165['ok'])throw new Error(_0x48ba89(0xde)+_0x570165[_0x48ba89(0xf2)]+')');const _0xdf3c3e=await _0x570165[_0x48ba89(0xca)]();if(_0xdf3c3e[_0x48ba89(0xba)])_0x47d3b0=_0xdf3c3e['api_key_custom'];else throw new Error(_0x48ba89(0xf6));}if(!_0x33a9c7||!_0x47d3b0)throw new Error('未在OpenAI设置中找到自定义URL或API密钥。');const _0x50795e=new URL(_0x33a9c7)[_0x48ba89(0xf4)],_0x2c159b=_0x50795e+_0x48ba89(0xda),_0x37c090=await fetch(_0x48ba89(0xea),{'method':_0x48ba89(0xc0),'headers':{'Content-Type':_0x48ba89(0xb7)},'body':JSON[_0x48ba89(0xd6)]({'apiKey':_0x47d3b0,'apiUrl':_0x2c159b})}),_0x253223=await _0x37c090['json']();if(_0x37c090['ok']){if(_0x253223['data']&&_0x253223[_0x48ba89(0xfb)][_0x48ba89(0xd1)]!==undefined){const _0x1535db=_0x253223['data'][_0x48ba89(0xd1)],_0x1d12c1=_0x1535db/0x7a120;console['log'](_0x48ba89(0xf1)+_0x1d12c1[_0x48ba89(0xd7)](0x2)+_0x48ba89(0xf3)+_0x1535db+')');const _0x3a6ce8=$(_0x48ba89(0xd0))['is'](_0x48ba89(0xef));_0x3a6ce8&&toastr[_0x48ba89(0xe9)](_0x48ba89(0xbb)+_0x1d12c1[_0x48ba89(0xd7)](0x2)+_0x48ba89(0xf3)+_0x1535db+')');}else{console[_0x48ba89(0xbc)]('API\x20Balance\x20Checker\x20Auto:\x20查询失败:\x20代理返回数据格式不正确。');const _0x490440=$('#api-balance-checker-auto-notify')['is'](':checked');_0x490440&&toastr[_0x48ba89(0xbc)](_0x48ba89(0xd3));}}else{console['error'](_0x48ba89(0xb4)+(_0x253223[_0x48ba89(0xbc)]||_0x48ba89(0xc5)+_0x37c090[_0x48ba89(0xf2)]));const _0x55c517=$(_0x48ba89(0xd0))['is'](_0x48ba89(0xef));_0x55c517&&toastr[_0x48ba89(0xbc)](_0x48ba89(0xf0)+(_0x253223[_0x48ba89(0xbc)]||_0x48ba89(0xc5)+_0x37c090['status']));}}catch(_0x1c2f40){console[_0x48ba89(0xbc)]('API\x20Balance\x20Checker\x20Auto\x20Error:',_0x1c2f40);const _0x30383a=$(_0x48ba89(0xd0))['is'](':checked');_0x30383a&&toastr[_0x48ba89(0xbc)](_0x48ba89(0xf0)+_0x1c2f40[_0x48ba89(0xd9)]);}}),$(document)['on']('click',_0x2ba6d6(0xfd),function(){const _0x21ab18=_0x2ba6d6,_0x5c2b8b=$(this)['next']('.inline-drawer-content'),_0x4878a5=$(this)[_0x21ab18(0xee)](_0x21ab18(0xcf));_0x5c2b8b['is'](_0x21ab18(0xcb))?(_0x5c2b8b['slideUp'](0xc8),_0x4878a5['removeClass']('up')[_0x21ab18(0xec)]('down')):(_0x5c2b8b[_0x21ab18(0xdd)](0xc8),_0x4878a5[_0x21ab18(0xe5)](_0x21ab18(0xb6))['addClass']('up'));});}));function a0_0x4e12(_0x47372b,_0x56f8d6){const _0x14682d=a0_0x1468();return a0_0x4e12=function(_0x4e1247,_0x593c4f){_0x4e1247=_0x4e1247-0xb2;let _0x50ce04=_0x14682d[_0x4e1247];if(a0_0x4e12['oxKLpS']===undefined){var _0x52f6fd=function(_0x3e423a){const _0x1b9d37='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x475931='',_0x21586a='';for(let _0x3fa9cc=0x0,_0x27ba7b,_0x3ba9a9,_0x480d86=0x0;_0x3ba9a9=_0x3e423a['charAt'](_0x480d86++);~_0x3ba9a9&&(_0x27ba7b=_0x3fa9cc%0x4?_0x27ba7b*0x40+_0x3ba9a9:_0x3ba9a9,_0x3fa9cc++%0x4)?_0x475931+=String['fromCharCode'](0xff&_0x27ba7b>>(-0x2*_0x3fa9cc&0x6)):0x0){_0x3ba9a9=_0x1b9d37['indexOf'](_0x3ba9a9);}for(let _0x59258e=0x0,_0x32a2df=_0x475931['length'];_0x59258e<_0x32a2df;_0x59258e++){_0x21586a+='%'+('00'+_0x475931['charCodeAt'](_0x59258e)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x21586a);};a0_0x4e12['liESSD']=_0x52f6fd,_0x47372b=arguments,a0_0x4e12['oxKLpS']=!![];}const _0x420fb8=_0x14682d[0x0],_0x1101c1=_0x4e1247+_0x420fb8,_0x1813fc=_0x47372b[_0x1101c1];return!_0x1813fc?(_0x50ce04=a0_0x4e12['liESSD'](_0x50ce04),_0x47372b[_0x1101c1]=_0x50ce04):_0x50ce04=_0x1813fc,_0x50ce04;},a0_0x4e12(_0x47372b,_0x56f8d6);}function a0_0x1468(){const _0x3196d0=['CMvTB3zLq2XHC3m','nLLcuhjgCq','y3vZDg9T','l2fWAs9ZzwnYzxrZl3zPzxC','Aw5MBW','Ahr0Chm6lY9HCgKUChjVEhKUEhv4DwuWnY5JBI9WCM94Es1Yzxf1zxn0','mJaYmdeWovbJCLj4va','ywrKq2XHC3m','mZK4nti0zg52z0jm','zMLUza','oMnOzwnRzwq','6iEQ5yQO5P+L6k+Iqvbj5l2z6AkD5AsX6lsLoIa','qvbjiejHBgfUy2uGywz0zxiGz2vUzxjHDgLVBJOG','C3rHDhvZ','icJLJP/LP4VLGlW6ia','B3jPz2LU','y3vZDg9Tx3vYBa','q3vZDg9TiefqssbRzxKGkgfWAv9RzxLFy3vZDg9TksbUB3qGzM91BMqGAw4GC2vJCMv0CY4','cIaGicaGicaGicaGidXKAxyGAwq9iMfWAs1IywXHBMnLlwnOzwnRzxiTyNv0Dg9UiIbJBgfZCZ0IzhjHD2vYiJ4kicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iMrYyxDLCI10B2DNBguIpGOGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iMrYyxDLCI1Py29UigzHlxnVBgLKigzHlxDHBgXLDcbMys1MDYbJBg9Zzwrjy29UigLUDgvYywn0ywjSzsiGDgL0Bgu9iUAFPEIVOUs9MEMINsiGzgf0ys1PmtHUpsjBDgL0BgvDq2HLy2SGqMfSyw5JzsiGDgfIAw5KzxG9iJaIihjVBgu9iMj1DhrVBIi+pc9KAxy+cIaGicaGicaGicaGicaGica8l2rPDJ4kicaGicaGicaGicaGpc9KAxy+cIaGicaGicaG','i2v4DgvUC2LVBNnFC2v0DgLUz3m','y2HHDf9JB21WBgv0Aw9Ux3nVDxjJzq','Dw5KzwzPBMvK','zgf0yq','i2v4DgvUC2LVBNmTC2v0DgLUz3mTyNv0Dg9U','i2fWAs1IywXHBMnLlwnOzwnRzxiTyxv0BY1Zzwn0Aw9Uic5PBMXPBMuTzhjHD2vYlxrVz2DSzq','zxzLBNrtB3vYy2u','zMeTC3bPBM5LCIbMys1ZCgLU','qvbjiejHBgfUy2uGq2HLy2TLCIbbDxrVoIdMN6xOR6lLPlhOTku6ia','z2v0q29UDgv4Da','zg93BG','yxbWBgLJyxrPB24VANnVBG','ndbVsK5SAMC','ndi3otC1wKruuwrL','yxbPx2TLEv9JDxn0B20','qvbj5y+V55sO6AkD5BQMoIa','zxjYB3i','qvbjiejHBgfUy2uGq2HLy2TLCJOGsw5PDgLHBgL6Aw5Nigj1DhrVBI4','Bg9N','i2fWAs1IywXHBMnLlwnOzwnRzxiTyNv0Dg9U','ue9tva','i2fWAs1IywXHBMnLlwnOzwnRzxiTyxv0BY1LBMfIBgvK','qvbjiejHBgfUy2uGq2HLy2TLCJOGt3bLBKfjihnLDhrPBMDZig5VDcbSB2fKzwqGzM9Yigf1Dg8Ty2HLy2SU','y2XPy2S','mtiYmJa2s05kzefr','5lUJ55cg5PYn5yQH5zMO6l+u5zUE54Q25Ocbia','ywn0AxzL','yxbPx2TLEq','Dg9Nz2XLq2XHC3m','z2v0uMvXDwvZDeHLywrLCNm','ANnVBG','oNzPC2LIBgu','qvbjiejHBgfUy2uGq2HLy2TLCIbfCNjVCJO','zMeTD2fSBgv0','BgvUz3rO','lMLUBgLUzs1KCMf3zxiTAwnVBG','i2fWAs1IywXHBMnLlwnOzwnRzxiTyxv0BY1UB3rPzNK','Dg90ywXFyxzHAwXHyMXL','5P+L6k+I5AsX6lsLoIa','6iEQ5yQO5P+L6k+Iqvbj5l2z6AkD5AsX6lsLoIdKU6pNKiBOV5tLM57MLBdMJA7MOlZLVi/KUi3MRApNOA7JGii','zxzLBNruExbLCW','ntaYnJG1nMHbCNzMAG','C3rYAw5NAwz5','Dg9gAxHLza','i2fWAs1IywXHBMnLlwnOzwnRzxiTyxv0BY1Zzwn0Aw9U','BwvZC2fNzq','l2fWAs91C2fNzs90B2TLBG','6i635y+w6iEQ5A6A5lMjqvbj5A+g6zkL5AsX6lsLoIa','mtm4mJG4uw1qEgTK','C2XPzgveB3DU','rMfPBgvKihrVigzLDgnOihnLy3jLDhmGzNjVBsaVyxbPl3nLy3jLDhmVDMLLDYaOC3rHDhvZoIa','cIaGicaGicaGicaGidXKAxyGAwq9iMfWAs1IywXHBMnLlwnOzwnRzxiTyxv0BY1Zzwn0Aw9UiJ4kicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iMLUBgLUzs1KCMf3zxiTDg9Nz2XLigLUBgLUzs1KCMf3zxiTAgvHzgvYiJ4kicaGicaGicaGicaGicaGicaGica8yIbKyxrHlwKXog49iKf1Dg8GqMfSyw5JzsbdAgvJAYi+6iEQ5yQO5P+L6k+I5l2z6AkDpc9IpGOGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iMLUBgLUzs1KCMf3zxiTAwnVBIbMys1ZB2XPzcbMys1JAxjJBguTy2HLDNjVBI1KB3DUigrVD24GAw50zxjHy3rHyMXLiIb0ywjPBMrLEd0ImciGCM9Szt0IyNv0Dg9UiJ48l2rPDJ4kicaGicaGicaGicaGicaGidWVzgL2pGOGicaGicaGicaGicaGicaGpgrPDIbJBgfZCZ0IAw5SAw5LlwrYyxDLCI1JB250zw50iIbZDhLSzt0IzgLZCgXHEtOGBM9UztSIpGOGicaGicaGicaGicaGicaGicaGidXKAxyGC3r5Bgu9iNbHzgrPBMC6ideWChG7iJ4kicaGicaGicaGicaGicaGicaGicaGicaGpgXHyMvSignSyxnZpsjJAgvJA2jVEf9SywjLBciGzM9YpsjHCgKTyMfSyw5Jzs1JAgvJA2vYlwf1Dg8Tzw5HyMXLzci+cIaGicaGicaGicaGicaGicaGicaGicaGicaGica8Aw5WDxqGDhLWzt0Iy2HLy2TIB3GIigLKpsjHCgKTyMfSyw5Jzs1JAgvJA2vYlwf1Dg8Tzw5HyMXLzci+cIaGicaGicaGicaGicaGicaGicaGicaGicaGica8C3bHBIbKyxrHlwKXog49iKf1Dg8Ty2HLy2SGyMfSyw5JzsbHzNrLCIbNzw5LCMf0Aw9UiJ7LNkJMR4/MRkhNLj/MIjdLROZMIjdLKi7OH6RLIQJMN6xOR6lKVzNPOP08l3nWyw4+cIaGicaGicaGicaGicaGicaGicaGicaGidWVBgfIzwW+cIaGicaGicaGicaGicaGicaGicaGicaGidXKAxyGy2XHC3m9iMnOzwnRyM94x2XHyMvSiIbZDhLSzt0IBwfYz2LUlxrVCdOGmtbWEdSIpGOGicaGicaGicaGicaGicaGicaGicaGicaGicaGpgLUChv0ihr5Cgu9iMnOzwnRyM94iIbPzd0IyxbPlwjHBgfUy2uTy2HLy2TLCI1HDxrVlw5VDgLMEsiGy2HLy2TLzd4kicaGicaGicaGicaGicaGicaGicaGicaGicaGidXZCgfUigrHDgeTAte4BJ0Iu2HVDYbUB3rPzMLJyxrPB24GB24Gyxv0BY1JAgvJAYi+6iEQ5yQO5P+L6k+I5PE25PI+56s66ycA55+Lpc9ZCgfUpGOGicaGicaGicaGicaGicaGicaGicaGica8l2rPDJ4kicaGicaGicaGicaGicaGicaGica8l2rPDJ4kicaGicaGicaGicaGicaGidWVzgL2pGOGicaGicaGicaGica8l2rPDJ4kicaGicaGica','yxbWzw5K','mta5mduYmtbtyxvXuNe','5PYQ5zYOt3bLBKfj6k6+572U5lIT5OM+5yIW6iEQ5A6A5lMjvvjm5OIwqvbj5A+g6zkL44cc','y2HHDenVBxbSzxrPB25tzxr0Aw5NCW','ywz0zxi'];a0_0x1468=function(){return _0x3196d0;};return a0_0x1468();}